<header-directive></header-directive>

	<!-- IF THERE IS NO LESSON -->
	<section class="smaller-wrapper" ng-show="!lesson">

		<div class="shift-wrapper">
			<div class="container">
				{{activeLesson}}
				<div class="profile-header">Create a new lesson</div>

				<div class="profile-container-body">
					<form ng-submit="updateUser(user, newPassword)">
						<div class="alert alert-success" role="alert" ng-if="displayMessage" hide-essage>Settings have been updated.</div>
						<label>Lesson topic: *</label>
						<form ng-submit="setTopic(topic)">
							<input class="form-control" placeholder="e.g. Javascript 101" ng-model="topic" required/>
						</form>
						<hr>

						<label>New section name:</label>
						<form ng-submit="addSection(newSection)">
							<input type="text" ng-model="newSection.title"
								   placeholder="e.g. Variables and functions"
								   class="form-control"/>

						   <text-angular ng-model="newSection.content"></text-angular>

						   <button class="btn btn-default">Create section</button>
						</form>

						<div ng-repeat="section in sections">
							<br>
							<hr ng-if="$index === 0">

							<h4>{{section.title}}</h4>
							<div ng-bind-html="section.content | unsafe"></div>

							<hr>
						</div>
						<br><br>
						<button class="btn btn-success" ng-click="createLesson(topic)">Save lesson</button>
					</form>
				</div>

			</div>
		</div>

	</section>


<!-- 	<div ng-show="!lesson">
		<div class="flex-row content-center align-items-center" ng-click="closeModal()"></div>
		<div class="flex-column align-items-center">
				<h3>Create a new lesson</h3>
					<form ng-submit="setTopic(topic)"/>
						<input class="" type="text" ng-model="topic" placeholder="Lesson topic" />
					</form>
					<h4>New Section</h4>
					<form ng-submit="addSection(newSection)">
						<input type="text" ng-model="newSection.title"
							   placeholder="Section title"
							   class="form-control"/>

					   <text-angular ng-model="newSection.content"></text-angular>

					   <button class="btn btn-default">Create section</button>
					</form>
					<br>
					<div ng-repeat="section in sections">
						<hr ng-if="$index === 0">

						<h4>{{section.title}}</h4>
						<div ng-bind-html="section.content | unsafe"></div>

						<hr>
					</div>
				<br><br>
				<button ng-click="createLesson(topic)" class="btn btn-success">Save lesson</button>
		</div>
	</div> -->



	<!-- IF THERE IS A LESSON -->
<section class="smaller-wrapper">
	<div class="shift-wrapper">	
		<div ng-show="lesson" class="portlet-header">
			<div ng-show="!lesson.edit">
				<h2>{{lesson.topic}} <i class="fa fa-pencil" ng-click="lesson.edit=!lesson.edit"></i></h2>
			</div>
			
			<span class="course-body">

				<!-- EDIT LESSON TITLE -->
				<div ng-show="lesson.edit">
					lesson topic: <input type="text" ng-model="lesson.topic"/>
					<!-- <button ng-click="updateLesson()">submit change</button> -->
				</div>

				<!-- LESSON INFO -->
				<div ng-repeat="section in lesson.sections track by $index" class="portlet-content">
					<div ng-show="!lesson.edit">
						<h3 ng-show="section.title">
							{{section.title}} 
							<!-- <i class="fa fa-pencil" ng-click="section.editSection=!section.editSection"></i> -->
						</h3> 
						<div ng-bind-html="section.content | unsafe"></div>
						<button ng-click="teachLesson(lesson)" ng-show="!day.instructor && user.userType !== 'student' && typeRef == 'cohort'">Teach this lesson</button> 
						<button ng-click="removeLesson(lesson)" ng-show="day.instructor == user._id && user.userType !== 'student' && typeRef == 'cohort'">Do not teach this lesson</button> 
					</div>
					<br />


					<!-- EDIT LESSON -->
					
					<div ng-show="lesson.edit">
						<i ng-show="lesson.edit" class="fa fa-times" ng-click="removeLessonSection($index, section)">delete section</i>
						<br />
						section title: <input type="text" ng-model="section.title"
								   placeholder="Section title"
								   class="form-control"/> 
						section content: <text-angular ng-model="section.content"></text-angular>
					</div>
					<br />
				</div>
				<!-- ADDS NEW SECTION TO A LESSON -->
				<i ng-show="lesson.edit" class="fa fa-plus" ng-click="newSection.show=!newSection.show">add section</i>
				<br />
				<form ng-show="newSection.show" ng-submit="addLessonSection(newSection)">
					<input type="text" ng-model="newSection.title"
						   placeholder="Section title"
						   class="form-control"/>

				   <text-angular ng-model="newSection.content"></text-angular>

				   <button class="btn btn-default">Create section</button>
				</form>
				<br />
				<button ng-show="lesson.edit" ng-click="updateLesson()">submit changes</button>
			</span>
		</div>
	</div>
</section>
<!-- </div> -->